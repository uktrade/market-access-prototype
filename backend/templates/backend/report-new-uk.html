{% extends './datahub_layout.html' %}
{% load staticfiles %}
{% load trans from i18n %}
{% block css %}
{% endblock %}
{% block head_title %}Data Hub - Trade Barriers{% endblock %}
{% block breadcrumb %}{% include 'backend/components/breadcrumb.html' with title="Company X v Country 1" %}{% endblock %}
{% block local_header__title_before %}{% endblock %}
{% block local_header__title %}
  Company X v Country 1
{% endblock %}
{% block local_header__meta %}
<div class="c-meta-list">
  Sector, Her Majestyâ€™s Government barrier type, Country, Date added
</div>
{% endblock %}
{% block local_header__progress %}{% endblock %}

{% block sidebar %}
  {% include 'backend/components/sidebar-nav--screening.html' with nav="barrier" extraNav="true" %}
{% endblock %}

{% block content %}
<h2 class="heading-medium">Create a new barrier record</h2>

<form action="{% url 'report-home-barrier-created' %}" method="get">

  {# Barrier record name #}
  <div class="form-group " id="barrier-record-name-wrapper">
      <label class="form-label-bold" for="barrier-record-name">
        Barrier record name
      </label>
      <span class="form-hint">
        Include both the product or service name and the country being
exported to eg. Import of steel rods into India
      </span>
      <input id="barrier-record-name" class="form-control" name="barrier_record_name" value="" type="text">
  </div>

  {# Summary (textarea) #}
  <div class="form-group " id="summary-wrapper">
      <label class="form-label-bold" for="summary">
          Summary
      </label>
      <span class="form-hint">
        Provide a brief summary of the report. It is for government use only.
      </span>
      <textarea id="summary" class="form-control" name="summary" cols="10" rows="5" maxlength="200"></textarea>
      <span class="form-hint" id="summary-count">
        200 characters max.
      </span>
  </div>
  <script>
    // Feedback to user how many characters they have left in their textarea
    // NOTE: This JS has been inlined because it's a prototype and only used once
    (function(){

      /**
       * {var} object
       * DOM element
       */
      var summary = document.getElementById('summary');

      /**
       * update the count message
       * @param {object} textarea the DOM object we are testing
       *
       * @return {void}
       */
      function updateCount(textarea){
        var length = textarea.value.length;
        var maxLength = parseInt(textarea.getAttribute('maxlength'), 10);
        var whatsLeft = (maxLength - length);
        var summaryCount = document.getElementById('summary-count');

        summaryCount.innerHTML = whatsLeft + ' character(s) left';
      }

      // Run everytime the user types _ no delay here we *don't* need to throttle/debounce
      summary.addEventListener('keyup', function(event){
        updateCount(event.target);
      });

      // Run onload, when data may be pre-populated
      window.addEventListener('load', function(){
        updateCount(summary);
      });
    })();
  </script>

  <div class="c-form-actions">
    <button class="button" type="submit">Save</button>
    <a href="{% url 'report-create-barrier' %}">Back</a>
  </div>

</form>
{% endblock %}